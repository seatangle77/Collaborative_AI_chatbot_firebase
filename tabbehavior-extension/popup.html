<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <style>
      body { font-family: sans-serif; padding: 10px; width: 300px; }
      ul { padding-left: 15px; }
      li { margin-bottom: 4px; font-size: 13px; }
      .label { font-weight: bold; }
      .initial { color: #2c7; }
      .duration { color: #36c; }
      button { margin-top: 10px; padding: 6px 10px; font-size: 13px; }
    </style>
  </head>
  <body>
    <h3>TabBehavior</h3>
    <p class="label">👤 当前用户：<span id="username">加载中...</span></p>
    <p class="label">🟢 当前激活标签页：</p>
    <p id="activeTab">正在检测...</p>

    <p class="label">⏱️ 最近一次标签页停留时间：</p>
    <p id="lastDuration">尚无记录</p>

    <p class="label">📑 当前打开的标签页：</p>
    <ul id="tabList">正在加载...</ul>
    <p class="label">📘 每个页面的停留历史记录：</p>
    <ul id="pageHistoryList">正在加载页面历史...</ul>
    <button id="refreshBtn">🔄 刷新记录</button>
    <hr />
    <p class="label">📢 发送消息通知：</p>
  <button onclick="sendNotification('Emma', '请尽快进入讨论状态，查看推荐文章并发言。')">🔔 通知 Emma</button>
  <button onclick="sendNotification('David', '请邀请 Emma 发表看法，促进她的参与。')">🔔 通知 David</button>
  <button onclick="sendNotification('Frank', '请发起一个问题，引导 Emma 加入讨论。')">🔔 通知 Frank</button>
  <script>
    function sendNotification(user, message) {
      if (Notification.permission === 'granted') {
        new Notification(`📢 给 ${user} 的通知`, {
          body: message,
          icon: 'icon.png'
        });
      } else if (Notification.permission !== 'denied') {
        Notification.requestPermission().then(permission => {
          if (permission === 'granted') {
            new Notification(`📢 给 ${user} 的通知`, {
              body: message,
              icon: 'icon.png'
            });
          }
        });
      }
    }
  </script>
    <script src="popup.js"></script>
  </body>
</html>